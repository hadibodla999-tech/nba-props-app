# THIS IS THE NEW .github/workflows/main.yml FILE

name: 'Run NBA Data Bot'

on:
  # 1. Run this workflow automatically every day at 5:00 AM UTC
  # (This is 10:00 AM in Pakistan, you can adjust this time)
  schedule:
    - cron: '0 5 * * *'
  
  # 2. Also allow running it manually from the "Actions" tab
  workflow_dispatch:

jobs:
  build-and-run-bot:
    runs-on: ubuntu-latest

    steps:
      # 1. Check out a copy of your repository
      - name: 'Checkout Repository'
        uses: actions/checkout@v4

      # 2. Set up the Python environment
      - name: 'Set up Python'
        uses: actions/setup-python@v5
        with:
          python-version: '3.11' # You can use 3.11, 3.12, etc.

      # 3. Install the required Python libraries
      - name: 'Install Dependencies'
        run: |
          python -m pip install --upgrade pip
          # We only need requests and firebase-admin for the backend
          pip install requests firebase-admin python-dotenv

      # 4. Run the bot script
      - name: 'Run Bot Script (Fetch and Save Data)'
        run: python api/get_data.py
        env:
          # These are your GitHub Secrets.
          # Your Python script will access these using os.environ.get()
          RAPIDAPI_KEY: ${{ secrets.RAPIDAPI_KEY }}
          FIREBASE_ADMIN_KEY: ${{ secrets.FIREBASE_ADMIN_KEY }}
